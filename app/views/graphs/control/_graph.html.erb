<div>
  <div id="container"></div>
  <script type="text/javascript" charset="utf-8">
    $(function () {
        $('#container').highcharts({
            chart: {
                type: 'scatter',
                zoomType: 'xy',
                height: 600
            },
            title: false,
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: {
                    day: '%e.%b',
                },
                title: {
                    text: 'Issue Transition Date'
                },
                startOnTick: true,
                endOnTick: true,
                showLastLabel: true
            },
            yAxis: {
                title: {
                    text: 'Elapsed Time / Work In Prograss (Days)'
                },
                min: 0
            },
            plotOptions: {
                scatter: {
                    marker: {
                        radius: 5,
                        states: {
                            hover: {
                                enabled: true,
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    },
                    states: {
                        hover: {
                            marker: {
                                enabled: false
                            }
                        }
                    },
                    tooltip: {
                        headerFormat: '',
                        // FIX : Add link to github issue by number.
                        pointFormat: 'Issue #{point.number}<br/>WIP: {point.y:.2f}d<br/>Closed: {point.x:%e. %b}'
                    }
                },
                line: {
                    enableMouseTracking: false
                }
            },
            series: [{
                name: 'Issue',
                color: 'rgba(119, 152, 191, .7)',
                data: [
                  <% @chart_series_data[:issues].each do |e| %>
                    {
                      x: <%=e[:x]%>,
                      y: <%=e[:y]%>,
                      number: <%=e[:number]%>
                    },
                  <% end %>
                ]
            },{
                name: 'Average',
                type: 'line',
                color: 'rgba(223, 83, 83, .7)',
                marker: {
                    enabled: false
                },
                data: [
                  <% @chart_series_data[:average].each do |e| %>
                    {
                      x: <%=e[:x]%>,
                      y: <%=e[:y]%>
                    },
                  <% end %>
                ]
            }]
        });
    });
  </script>
</div>
